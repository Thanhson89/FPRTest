open Interval
open Opt_func


let start_interval = Array.init 3 (function
| 0 -> {low = -1.00000000000000000000e+00; high = 1.00000000000000000000e+00}
| 1 -> {low = -1.00000000000000000000e+00; high = 1.00000000000000000000e+00}
| 2 -> {low = -1.00000000000000000000e+00; high = 1.00000000000000000000e+00}
| _ -> failwith "Out of boundaries"
)

let f_X input_array = 
  let var_x0 = input_array.(0) in
  let var_x1 = input_array.(1) in
  let var_x2 = input_array.(2) in
(abs_I((((cos_I(((({low = -5.59933389384351976048e+00; high = -5.59933389384351887230e+00} *$ var_x0) +$ ({low = 4.34049356622710025277e+00; high = 4.34049356622710114095e+00} *$ var_x1)) +$ ({low = -9.37819360512655642026e+00; high = -9.37819360512655464390e+00} *$ var_x2))) *$ (var_x0 *$ {low = -2.19313378846310413905e+00; high = -2.19313378846310369497e+00})) +$ (cos_I(((({low = -5.59933389384351976048e+00; high = -5.59933389384351887230e+00} *$ var_x0) +$ ({low = 4.34049356622710025277e+00; high = 4.34049356622710114095e+00} *$ var_x1)) +$ ({low = -9.37819360512655642026e+00; high = -9.37819360512655464390e+00} *$ var_x2))) *$ (var_x1 *$ {low = -1.89279762146918417720e+00; high = -1.89279762146918395516e+00}))) +$ (cos_I(((({low = -5.59933389384351976048e+00; high = -5.59933389384351887230e+00} *$ var_x0) +$ ({low = 4.34049356622710025277e+00; high = 4.34049356622710114095e+00} *$ var_x1)) +$ ({low = -9.37819360512655642026e+00; high = -9.37819360512655464390e+00} *$ var_x2))) *$ (var_x2 *$ {low = 4.19697307942911912448e+00; high = 4.19697307942912001266e+00})))) +$ (abs_I((cos_I(((({low = -5.59933389384351976048e+00; high = -5.59933389384351887230e+00} *$ var_x0) +$ ({low = 4.34049356622710025277e+00; high = 4.34049356622710114095e+00} *$ var_x1)) +$ ({low = -9.37819360512655642026e+00; high = -9.37819360512655464390e+00} *$ var_x2))) *$ floor_power2_I((({low = -5.59933389384351976048e+00; high = -5.59933389384351887230e+00} *$ var_x0) +$ {low = -1.30720960406250008288e-07; high = 1.30720960406250008288e-07})))) +$ (abs_I((cos_I(((({low = -5.59933389384351976048e+00; high = -5.59933389384351887230e+00} *$ var_x0) +$ ({low = 4.34049356622710025277e+00; high = 4.34049356622710114095e+00} *$ var_x1)) +$ ({low = -9.37819360512655642026e+00; high = -9.37819360512655464390e+00} *$ var_x2))) *$ floor_power2_I((({low = 4.34049356622710025277e+00; high = 4.34049356622710114095e+00} *$ var_x1) +$ {low = -1.12819529859375010562e-07; high = 1.12819529859375010562e-07})))) +$ (abs_I((cos_I(((({low = -5.59933389384351976048e+00; high = -5.59933389384351887230e+00} *$ var_x0) +$ ({low = 4.34049356622710025277e+00; high = 4.34049356622710114095e+00} *$ var_x1)) +$ ({low = -9.37819360512655642026e+00; high = -9.37819360512655464390e+00} *$ var_x2))) *$ floor_power2_I(((({low = -5.59933389384351976048e+00; high = -5.59933389384351887230e+00} *$ var_x0) +$ ({low = 4.34049356622710025277e+00; high = 4.34049356622710114095e+00} *$ var_x1)) +$ {low = -7.20377648468750085025e-07; high = 7.20377648468750085025e-07})))) +$ (abs_I((cos_I(((({low = -5.59933389384351976048e+00; high = -5.59933389384351887230e+00} *$ var_x0) +$ ({low = 4.34049356622710025277e+00; high = 4.34049356622710114095e+00} *$ var_x1)) +$ ({low = -9.37819360512655642026e+00; high = -9.37819360512655464390e+00} *$ var_x2))) *$ floor_power2_I((({low = -9.37819360512655642026e+00; high = -9.37819360512655464390e+00} *$ var_x2) +$ {low = -2.50159089531250000755e-07; high = 2.50159089531250000755e-07})))) +$ (abs_I((cos_I(((({low = -5.59933389384351976048e+00; high = -5.59933389384351887230e+00} *$ var_x0) +$ ({low = 4.34049356622710025277e+00; high = 4.34049356622710114095e+00} *$ var_x1)) +$ ({low = -9.37819360512655642026e+00; high = -9.37819360512655464390e+00} *$ var_x2))) *$ floor_power2_I((((({low = -5.59933389384351976048e+00; high = -5.59933389384351887230e+00} *$ var_x0) +$ ({low = 4.34049356622710025277e+00; high = 4.34049356622710114095e+00} *$ var_x1)) +$ ({low = -9.37819360512655642026e+00; high = -9.37819360512655464390e+00} *$ var_x2)) +$ {low = -1.92421105440625077399e-06; high = 1.92421105440625077399e-06})))) +$ abs_I(floor_power2_I((sin_I(((({low = -5.59933389384351976048e+00; high = -5.59933389384351887230e+00} *$ var_x0) +$ ({low = 4.34049356622710025277e+00; high = 4.34049356622710114095e+00} *$ var_x1)) +$ ({low = -9.37819360512655642026e+00; high = -9.37819360512655464390e+00} *$ var_x2))) +$ {low = -2.87788951192460440651e-06; high = 2.87788951192460440651e-06})))))))))

let _ =
  let x_tol = size_max_X start_interval *. 0.000000e+00 +. 1.000000e-02 in
  let upper_bound, lower_bound, c = Opt0.opt f_X start_interval x_tol (1.000000e-02) (1.000000e-02) (1000000) in
  let () = Printf.printf "iter_max = %d\n" c in
  let () = Printf.printf "max = %0.20e\n" upper_bound in
  let () = Printf.printf "lower_max = %0.20e\n" lower_bound in
  let () = Printf.printf "iter_min = 0\n" in
  let () = Printf.printf "min = 0\n" in
  let () = Printf.printf "lower_min = 0\n" in
  flush stdout
